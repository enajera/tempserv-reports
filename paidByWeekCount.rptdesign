<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="author">Greenfield Software, Inc. (All rights reserved!)</property>
    <property name="createdBy">Eclipse BIRT Designer Version 4.4.2.v201410272105 Build &lt;4.4.2.v20150217-1805></property>
    <text-property name="title">Paid By Week Count</text-property>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[
function canViewStaff(estaff) {
var secLevel = params["secLevel"].value;
var viewStaffe = params["viewStaffe"].value;
var viewStaffm = params["viewStaffm"].value;
var viewStaffy = params["viewStaffy"].value;
if (estaff === "E" &amp;&amp; secLevel !== viewStaffe)return false;
if (estaff === "M" &amp;&amp; secLevel < viewStaffm)return false;
if (estaff === "Y" &amp;&amp; secLevel < viewStaffy) return false;
return true;
}

function phoneNumberFormat(value) {
    try {
       
        if (value === '0000000000') {
            value = '';
        } else {
            if (value.substring(0, 3) === '000') {
                value = value.substring(3, 6) + '-' + value.substring(6, 10);
            } else {
                value = '(' + value.substring(0, 3) + ') ' + value.substring(3, 6) + '-' + value.substring(6, 10);
            }
        }
        return value;
    } catch (e) {
        return '';
    }
}

function getSocialSecurityNumber(SSN) {
    function formatSSN(ssn) {
        var ssnString = ('000000000' + ssn).slice(-9);
        return ssnString.substring(0, 3) + '-' +
               ssnString.substring(3, 5) + '-' +
               ssnString.substring(5, 9);
    }

    var canViewSSN = params["canViewSSN"].value;
    var secLevel = params["secLevel"].value;

    var ssnDigits = digitsOnly(SSN);
    ssnDigits = ('000000000' + ssnDigits).slice(-9);

    if (secLevel < canViewSSN) {
        return "XXX-XX-" + ssnDigits.substring(5, 9);
    } else {
        return formatSSN(ssnDigits);
    }
}



function zipCodeFormat(value, all) {
    try {
        if (value.length < 5) {
            value = '00000'.substring(0, 5 - value.length) + value;
        }

        value = value + '000000000'.substring(0, 9 - value.length);

        if (value === '000000000') {
            value = '';
        } else {
            if (all === '1') {
                // Format XXXXX-XXXX
                value = value.substring(0, 5) + '-' + value.substring(5, 9);
            } else {
                // Formato XXXXX
                value = value.substring(0, 5);
            }
        }

        return value;

    } catch (e) {
       
        return 'err';
    }
}


function digitsOnly(value) {
    if (typeof value !== 'string') {
        value = String(value);
    }
    return value.replace(/\D/g, '');
}

function GLAccountFormat(value) {
    try {
        var glAccountFormat = "5";  
        value = "0"+digitsOnly(value)+'000000000'.substring(0, 9 - digitsOnly(value).length);

        if (value === '000000000') {
            value = '';
        } else {
            value = value.substring(0, parseInt(glAccountFormat)) + '-' +
                    value.substring(parseInt(glAccountFormat), 9);
        }

        return value;
    } catch (e) {
          return '';
    }
}

function getAuthoritySecurityLevel(action, dbCode, userid) {
    var secLevel = 0; 
    var found = false;

    if (action.trim() === "") {
        return secLevel;
    }
    if (dbCode.trim() === "") {
        return 10;
    }
    if (userid.trim() === "") {
        return 10;
    }

    try {
       
        var conn = reportContext.getConnection();
        var stmt = conn.prepareStatement("SELECT alseclevel FROM " + dbCode + "DATA.AUTHLVLPF WHERE UPPER(alid)=?");
        stmt.setString(1, action.toUpperCase());
        var rs = stmt.executeQuery();

        if (rs.next()) {
            var levelStr = rs.getString("alseclevel");
            if (levelStr &amp;&amp; levelStr.trim() !== "") {
                levelStr = levelStr.replace(/\D/g, "");
                secLevel = parseInt(levelStr);
            }
            found = true;
        }
        rs.close();
        stmt.close();
        conn.close();
    } catch (e) {
        java.lang.System.out.println("Error al obtener nivel de seguridad: " + e);
    }

    if (!found) {
        try {
            var conn = reportContext.getConnection();
            var stmt = conn.createStatement();
            stmt.executeUpdate("INSERT INTO " + dbCode + "DATA.AUTHLVLPF (SELECT * FROM ##DATA.AUTHLVLPF WHERE UPPER(alid)='" + action.toUpperCase() + "')");
            stmt.close();
            conn.close();
        } catch (e) {
            java.lang.System.out.println("Error al insertar registro de seguridad: " + e);
        }
    }

    var override = "";
    try {
        var conn = reportContext.getConnection();
        var stmt = conn.prepareStatement("SELECT uaoovrride FROM " + dbCode + "DATA.USRAUTOVR WHERE uaouserid=? AND UPPER(uaoalid)=?");
        stmt.setString(1, userid.toUpperCase().trim());
        stmt.setString(2, action.toUpperCase());
        var rs = stmt.executeQuery();
        if (rs.next()) {
            override = rs.getString("uaoovrride");
        }
        rs.close();
        stmt.close();
        conn.close();
    } catch (e) {
        java.lang.System.out.println("Error al obtener override: " + e);
    }

    if (override.trim() !== "") {
        if (override.trim() === "A") {
            secLevel = 0;
        } else if (override.trim() === "D") {
            secLevel = 10;
        }
    }
    
    return secLevel;
}
















]]></method>
    <method name="beforeFactory"><![CDATA[reportTotals = new Array(54);
for (var i = 0; i < 54; i++) {
    reportTotals[i] = 0;
}
]]></method>
    <property name="iconFile">/templates/first_report.gif</property>
    <property name="cheatSheet">org.eclipse.birt.report.designer.ui.cheatsheet.firstreport</property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">110</property>
    <parameters>
        <scalar-parameter name="dates_info" id="1630">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="javascript">Formatter.format(BirtDateTime.today(),"MM/dd/yy")+" thru "+Formatter.format(BirtDateTime.today(),"MM/dd/yy") &#13;
//"Status: All, Type: All, State: All, I9 Status: All"</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="viewStaffe" id="1632">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">9</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="viewStaffm" id="1633">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">9</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="viewStaffy" id="1634">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">9</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="secLevel" id="1635">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">9</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="middleTopHeader" id="1907">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">Payroll Year: 2018</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="header_report_name" id="1909">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="javascript">"Paid By Week Count"</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="access_denied" id="3011">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">0</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="sord" id="3032">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">T</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="qiseries" id="7">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.ibm.db2.jcc.DB2Driver</property>
            <property name="odaURL">jdbc:db2://localhost:50000/qiseries:currentSchema=TEMPSERVD;</property>
            <property name="odaUser">jdbc</property>
            <encrypted-property name="odaPassword" encryptionID="base64">amF2YXNxbA==</encrypted-property>
        </oda-data-source>
        <script-data-source name="scripted" id="4288"/>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="PaidByWeekCount" id="3777">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">detailCounter</property>
                    <expression name="expression">if( reportContext.getGlobalVariable("myCounter") == null ){&#13;
    reportContext.setGlobalVariable("myCounter", 0);&#13;
}&#13;
var x = reportContext.getGlobalVariable("myCounter");&#13;
x++;&#13;
reportContext.setGlobalVariable("myCounter", x);&#13;
x</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">HOFFIC</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">HOFFIC</text-property>
                    <text-property name="heading">HOFFIC</text-property>
                </structure>
                <structure>
                    <property name="columnName">OFFNAM</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">OFFNAM</text-property>
                    <text-property name="heading">OFFNAM</text-property>
                </structure>
                <structure>
                    <property name="columnName">WEEK</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">WEEK</text-property>
                    <text-property name="heading">WEEK</text-property>
                </structure>
                <structure>
                    <property name="columnName">PAID</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">PAID</text-property>
                    <text-property name="heading">PAID</text-property>
                </structure>
            </list-property>
            <list-property name="parameters"/>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">HOFFIC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">OFFNAM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">WEEK</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">PAID</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">detailCounter</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <method name="onFetch"><![CDATA[var weekNum = row["WEEK"];
var paidVal = row["PAID"];
if (weekNum != null &amp;&amp; paidVal != null) {
    reportTotals[weekNum - 1] += paidVal; 
}
]]></method>
            <property name="dataSource">qiseries</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">HOFFIC</property>
                    <property name="nativeName">HOFFIC</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">OFFNAM</property>
                    <property name="nativeName">OFFNAM</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">WEEK</property>
                    <property name="nativeName">WEEK</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">PAID</property>
                    <property name="nativeName">PAID</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[SELECT
	hoffic,
	COALESCE(offnam, '') AS offnam,
	week,
	count(*) AS paid
FROM
	(
	SELECT
		hoffic,
		hempno,
		WEEK(htrdate) AS week
	FROM
		TTDATA.PAYHSTPF
	WHERE
		YEAR(htrdate)= 2018
		AND hoffic IN (001, 002, 003, 004, 005, 006, 007, 041, 060, 081, 089)
		GROUP BY hoffic,
		hempno,
		WEEK(htrdate)
	ORDER BY
		hoffic,
		week,
		hempno) AS A
LEFT OUTER JOIN TTDATA.OFCMSTPF ON
	hoffic = offnum
GROUP BY
	hoffic,
	COALESCE(offnam, ''),
	week
ORDER BY
	hoffic,
	COALESCE(offnam, ''),
	week;]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>HDCODE</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>4</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>HDCODE</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>HDCODE</design:label>
            <design:formattingHints>
              <design:displaySize>6</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>HEMPNO</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>6</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>HEMPNO</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>HEMPNO</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>OFFNAM</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>25</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>OFFNAM</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>OFFNAM</design:label>
            <design:formattingHints>
              <design:displaySize>25</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>ENAME</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>25</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ENAME</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ENAME</design:label>
            <design:formattingHints>
              <design:displaySize>25</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>ELNAME</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>15</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ELNAME</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ELNAME</design:label>
            <design:formattingHints>
              <design:displaySize>15</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>EFNAME</design:name>
              <design:position>6</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>15</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>EFNAME</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>EFNAME</design:label>
            <design:formattingHints>
              <design:displaySize>15</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>ESTAFF</design:name>
              <design:position>7</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>1</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ESTAFF</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ESTAFF</design:label>
            <design:formattingHints>
              <design:displaySize>1</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>DDESCR</design:name>
              <design:position>8</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>25</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>DDESCR</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>DDESCR</design:label>
            <design:formattingHints>
              <design:displaySize>25</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>HDAMT</design:name>
              <design:position>9</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>3</design:nativeDataTypeCode>
            <design:precision>31</design:precision>
            <design:scale>2</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>HDAMT</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>HDAMT</design:label>
            <design:formattingHints>
              <design:displaySize>33</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <script-data-set name="WeeksTotals" id="4289">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">week</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">total</property>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">week</property>
                </structure>
                <structure>
                    <property name="columnName">total</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">week</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">total</property>
                        <property name="dataType">decimal</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">scripted</property>
            <method name="open"><![CDATA[grandWeek = 1;
]]></method>
            <method name="fetch"><![CDATA[if (grandWeek <= 54) {
    row["week"] = grandWeek;
    row["total"] = reportTotals[grandWeek - 1] != null ? reportTotals[grandWeek - 1] : 0;
    grandWeek++;
    return true;
} else {
    return false;
}
]]></method>
        </script-data-set>
    </data-sets>
    <styles>
        <style name="report" id="110">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">10pt</property>
        </style>
        <style name="crosstab" id="246">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">8pt</property>
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
            <property name="marginBottom">5pt</property>
        </style>
        <style name="crosstab-cell" id="247">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="orientation">portrait</property>
            <property name="topMargin">0.10909090909090909in</property>
            <property name="leftMargin">0.21818181818181817in</property>
            <property name="bottomMargin">0.06363636363636363in</property>
            <property name="rightMargin">0in</property>
            <page-header>
                <grid id="1547">
                    <property name="whiteSpace">nowrap</property>
                    <property name="display">block</property>
                    <property name="width">10.790909090909091in</property>
                    <column id="1548"/>
                    <column id="1549"/>
                    <column id="1550"/>
                    <column id="1551"/>
                    <column id="1552"/>
                    <column id="1553"/>
                    <column id="1554"/>
                    <column id="1555"/>
                    <column id="1556"/>
                    <column id="1557"/>
                    <column id="1558"/>
                    <column id="1559"/>
                    <column id="1560"/>
                    <column id="1674"/>
                    <column id="1676"/>
                    <column id="1561">
                        <property name="width">0.990909090909091in</property>
                    </column>
                    <column id="1562">
                        <property name="fontSize">8pt</property>
                        <property name="textAlign">right</property>
                        <property name="width">0.38181818181818183in</property>
                    </column>
                    <column id="1563">
                        <property name="fontSize">8pt</property>
                        <property name="width">0.5636363636363636in</property>
                    </column>
                    <row id="1564">
                        <cell id="1565"/>
                        <cell id="1566"/>
                        <cell id="1567"/>
                        <cell id="1568"/>
                        <cell id="1569"/>
                        <cell id="1570"/>
                        <cell id="1571"/>
                        <cell id="1572"/>
                        <cell id="1573"/>
                        <cell id="1574"/>
                        <cell id="1575"/>
                        <cell id="1576"/>
                        <cell id="1577">
                            <text id="1623">
                                <property name="fontSize">8pt</property>
                                <property name="fontWeight">bold</property>
                                <property name="marginTop">20pt</property>
                                <property name="marginRight">0pt</property>
                                <property name="paddingTop">1pt</property>
                                <property name="paddingLeft">1pt</property>
                                <property name="textAlign">right</property>
                                <property name="contentType">auto</property>
                                <text-property name="content"><![CDATA[Page:]]></text-property>
                            </text>
                        </cell>
                        <cell id="1673">
                            <auto-text id="1581">
                                <property name="fontSize">8pt</property>
                                <property name="fontWeight">bold</property>
                                <property name="marginTop">20pt</property>
                                <property name="paddingTop">1pt</property>
                                <property name="paddingLeft">0pt</property>
                                <property name="paddingRight">0pt</property>
                                <property name="type">page-number</property>
                            </auto-text>
                        </cell>
                        <cell id="1675"/>
                        <cell id="1578"/>
                        <cell id="1579">
                            <property name="paddingTop">1pt</property>
                        </cell>
                        <cell id="1580"/>
                    </row>
                </grid>
            </page-header>
        </simple-master-page>
    </page-setup>
    <body>
        <table name="Summary" id="3215">
            <property name="marginTop">-14pt</property>
            <property name="marginLeft">2pt</property>
            <property name="marginRight">2pt</property>
            <property name="display">block</property>
            <property name="canShrink">true</property>
            <property name="width">2.5in</property>
            <property name="dataSet">PaidByWeekCount</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">HOFFIC</property>
                    <text-property name="displayName">HOFFIC</text-property>
                    <expression name="expression" type="javascript">dataSetRow["HOFFIC"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">OFFNAM</property>
                    <text-property name="displayName">OFFNAM</text-property>
                    <expression name="expression" type="javascript">dataSetRow["OFFNAM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">WEEK</property>
                    <text-property name="displayName">WEEK</text-property>
                    <expression name="expression" type="javascript">dataSetRow["WEEK"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">PAID</property>
                    <text-property name="displayName">PAID</text-property>
                    <expression name="expression" type="javascript">dataSetRow["PAID"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">detailCounter</property>
                    <text-property name="displayName">detailCounter</text-property>
                    <expression name="expression" type="javascript">dataSetRow["detailCounter"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Today</property>
                    <expression name="expression" type="javascript">BirtDateTime.today()</expression>
                    <property name="dataType">date</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">week</property>
                    <expression name="expression" type="javascript">dataSetRow["WEEK"]</expression>
                    <property name="dataType">integer</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Paid</property>
                    <expression name="expression" type="javascript">dataSetRow["PAID"]</expression>
                    <property name="dataType">integer</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Branch</property>
                    <expression name="expression" type="javascript">Formatter.format(dataSetRow["HOFFIC"],"000")+" "+dataSetRow["OFFNAM"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <property name="sortByGroups">false</property>
            <column id="3437">
                <property name="width">2.3545454545454545in</property>
            </column>
            <column id="3438">
                <property name="width">0.9in</property>
            </column>
            <column id="3440">
                <property name="width">0.7454545454545455in</property>
            </column>
            <column id="3441">
                <property name="width">1.809090909090909in</property>
            </column>
            <column id="3442">
                <property name="width">0.6272727272727273in</property>
            </column>
            <column id="3448">
                <property name="width">0.5727272727272728in</property>
            </column>
            <column id="3449">
                <property name="width">0.5727272727272728in</property>
            </column>
            <column id="3450">
                <property name="width">0.41818181818181815in</property>
            </column>
            <header>
                <row id="3216">
                    <cell id="3217">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">1</property>
                        <data id="3218">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="marginBottom">0pt</property>
                            <property name="textAlign">left</property>
                            <list-property name="boundDataColumns">
                                <structure>
                                    <property name="name">header_report_name</property>
                                    <expression name="expression" type="javascript">params["header_report_name"]</expression>
                                    <property name="dataType">string</property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">header_report_name</property>
                        </data>
                    </cell>
                    <cell id="3219">
                        <property name="colSpan">3</property>
                        <property name="rowSpan">1</property>
                        <property name="fontSize">8pt</property>
                        <data id="3222">
                            <property name="fontWeight">bold</property>
                            <list-property name="boundDataColumns">
                                <structure>
                                    <property name="name">dates_info</property>
                                    <expression name="expression" type="javascript">params["middleTopHeader"].value</expression>
                                    <property name="dataType">string</property>
                                    <property name="allowExport">true</property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">dates_info</property>
                        </data>
                    </cell>
                    <cell id="3644">
                        <property name="fontSize">8pt</property>
                    </cell>
                    <cell id="3226"/>
                    <cell id="3227">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">1</property>
                    </cell>
                    <cell id="3228"/>
                </row>
            </header>
            <group id="3229">
                <property name="groupName">Branch_Group</property>
                <expression name="keyExpr" type="javascript">row["HOFFIC"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["HOFFIC"]</expression>
                </structure>
                <property name="hideDetail">false</property>
                <property name="pageBreakAfter">always</property>
                <property name="pageBreakBefore">auto</property>
                <header>
                    <row id="3230">
                        <property name="height">0.39090909090909093in</property>
                        <cell id="3231">
                            <property name="colSpan">1</property>
                            <property name="rowSpan">1</property>
                            <text id="3232">
                                <property name="fontSize">8pt</property>
                                <property name="fontWeight">bold</property>
                                <property name="marginBottom">5pt</property>
                                <property name="paddingBottom">8pt</property>
                                <property name="contentType">auto</property>
                                <text-property name="content"><![CDATA[TempServ Testing]]></text-property>
                            </text>
                        </cell>
                        <cell id="3233">
                            <property name="colSpan">3</property>
                            <property name="rowSpan">1</property>
                            <property name="fontSize">8pt</property>
                            <property name="textAlign">center</property>
                            <data id="3236">
                                <property name="fontSize">8pt</property>
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">Branch</property>
                            </data>
                        </cell>
                        <cell id="3646"/>
                        <cell id="3239">
                            <property name="colSpan">3</property>
                            <property name="rowSpan">1</property>
                            <data id="3241">
                                <property name="fontSize">8pt</property>
                                <property name="fontWeight">bold</property>
                                <structure name="dateTimeFormat">
                                    <property name="category">Custom</property>
                                    <property name="pattern">EEEE, MMMM dd, yy hh:mm a</property>
                                </structure>
                                <property name="textAlign">right</property>
                                <property name="resultSetColumn">Today</property>
                            </data>
                        </cell>
                    </row>
                    <row id="3282">
                        <property name="backgroundColor">#DCDCDC</property>
                        <property name="fontSize">8pt</property>
                        <property name="verticalAlign">top</property>
                        <property name="height">0.19in</property>
                        <cell id="3283">
                            <label id="3284">
                                <property name="fontFamily">sans-serif</property>
                                <property name="fontSize">8pt</property>
                                <property name="fontWeight">bold</property>
                                <property name="marginBottom">-1pt</property>
                                <property name="paddingTop">0pt</property>
                                <property name="paddingBottom">0pt</property>
                                <property name="textAlign">left</property>
                                <text-property name="text">Week Of Year</text-property>
                            </label>
                        </cell>
                        <cell id="3285">
                            <text id="4150">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">left</property>
                                <property name="contentType">auto</property>
                                <text-property name="content"><![CDATA[Paid]]></text-property>
                            </text>
                        </cell>
                        <cell id="3289"/>
                        <cell id="3291"/>
                        <cell id="3293"/>
                        <cell id="3305">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                        </cell>
                        <cell id="3307">
                            <property name="textAlign">right</property>
                        </cell>
                        <cell id="3309">
                            <property name="textAlign">right</property>
                        </cell>
                    </row>
                </header>
                <footer>
                    <row id="3311">
                        <property name="pageBreakAfter">avoid</property>
                        <list-property name="visibility">
                            <structure>
                                <property name="format">all</property>
                            </structure>
                        </list-property>
                        <cell id="3312">
                            <property name="fontSize">7pt</property>
                        </cell>
                        <cell id="3313">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                        </cell>
                        <cell id="3315">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                        </cell>
                        <cell id="3316">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                        </cell>
                        <cell id="3317">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                        </cell>
                        <cell id="3323">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                        </cell>
                        <cell id="3324">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                        </cell>
                        <cell id="3325">
                            <property name="fontSize">7pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                        </cell>
                    </row>
                </footer>
            </group>
            <detail>
                <row id="4168">
                    <list-property name="highlightRules">
                        <structure>
                            <property name="operator">eq</property>
                            <expression name="testExpr" type="javascript">row.__rownum % 2</expression>
                            <simple-property-list name="value1">
                                <value type="javascript">0</value>
                            </simple-property-list>
                        </structure>
                        <structure>
                            <property name="operator">ne</property>
                            <property name="backgroundColor">#F0F0F0</property>
                            <expression name="testExpr" type="javascript">row.__rownum % 2</expression>
                            <simple-property-list name="value1">
                                <value type="javascript">0</value>
                            </simple-property-list>
                        </structure>
                    </list-property>
                    <cell id="4169">
                        <data id="4166">
                            <property name="fontSize">8pt</property>
                            <property name="textAlign">left</property>
                            <property name="resultSetColumn">week</property>
                        </data>
                    </cell>
                    <cell id="4170">
                        <data id="4167">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">normal</property>
                            <structure name="numberFormat">
                                <property name="category">Unformatted</property>
                            </structure>
                            <property name="resultSetColumn">Paid</property>
                        </data>
                    </cell>
                    <cell id="4171"/>
                    <cell id="4172"/>
                    <cell id="4173"/>
                    <cell id="4175"/>
                    <cell id="4176"/>
                    <cell id="4177"/>
                </row>
            </detail>
        </table>
        <table name="Grand Totals" id="4178">
            <property name="marginTop">-14pt</property>
            <property name="marginLeft">2pt</property>
            <property name="marginRight">2pt</property>
            <property name="canShrink">true</property>
            <property name="width">2.5in</property>
            <property name="dataSet">WeeksTotals</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">today</property>
                    <expression name="expression" type="javascript">BirtDateTime.today()</expression>
                    <property name="dataType">date</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">week</property>
                    <expression name="expression" type="javascript">dataSetRow["week"]</expression>
                    <property name="dataType">integer</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">total</property>
                    <text-property name="displayName">total</text-property>
                    <expression name="expression" type="javascript">dataSetRow["total"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">paid</property>
                    <expression name="expression" type="javascript">dataSetRow["total"] == null ? 0 :dataSetRow["total"]</expression>
                    <property name="dataType">decimal</property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <property name="pageBreakInterval">65</property>
            <property name="sortByGroups">false</property>
            <column id="4234">
                <property name="width">2.355in</property>
            </column>
            <column id="4235">
                <property name="width">0.9090909090909091in</property>
            </column>
            <column id="4236">
                <property name="width">0.7545454545454545in</property>
            </column>
            <column id="4237">
                <property name="width">1.809090909090909in</property>
            </column>
            <column id="4238">
                <property name="width">0.6272727272727273in</property>
            </column>
            <column id="4240">
                <property name="width">0.5727272727272728in</property>
            </column>
            <column id="4241">
                <property name="width">0.5727272727272728in</property>
            </column>
            <column id="4242">
                <property name="width">0.41818181818181815in</property>
            </column>
            <header>
                <row id="4179">
                    <cell id="4180">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">1</property>
                        <data id="4181">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                            <list-property name="boundDataColumns">
                                <structure>
                                    <property name="name">header_report_name</property>
                                    <expression name="expression" type="javascript">params["header_report_name"]</expression>
                                    <property name="dataType">string</property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">header_report_name</property>
                        </data>
                    </cell>
                    <cell id="4182">
                        <property name="colSpan">3</property>
                        <property name="rowSpan">1</property>
                        <property name="fontSize">8pt</property>
                        <data id="4184">
                            <property name="fontWeight">bold</property>
                            <list-property name="boundDataColumns">
                                <structure>
                                    <property name="name">dates_info</property>
                                    <expression name="expression" type="javascript">params["middleTopHeader"].value</expression>
                                    <property name="dataType">string</property>
                                    <property name="allowExport">true</property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">dates_info</property>
                        </data>
                    </cell>
                    <cell id="4185">
                        <property name="fontSize">8pt</property>
                    </cell>
                    <cell id="4187"/>
                    <cell id="4188">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">1</property>
                    </cell>
                    <cell id="4189"/>
                </row>
                <row id="4243">
                    <cell id="4244">
                        <property name="paddingBottom">5pt</property>
                        <text id="4193">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="marginBottom">5pt</property>
                            <property name="paddingBottom">8pt</property>
                            <property name="textAlign">left</property>
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[TempServ Testing]]></text-property>
                        </text>
                    </cell>
                    <cell id="4245">
                        <property name="colSpan">3</property>
                        <property name="rowSpan">1</property>
                        <property name="fontSize">8pt</property>
                        <text id="4254">
                            <property name="fontWeight">bold</property>
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[Grand Totals]]></text-property>
                        </text>
                    </cell>
                    <cell id="4248">
                        <property name="fontSize">8pt</property>
                    </cell>
                    <cell id="4249">
                        <property name="colSpan">3</property>
                        <property name="rowSpan">1</property>
                        <data id="4199">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <structure name="dateTimeFormat">
                                <property name="category">Custom</property>
                                <property name="pattern">EEEE, MMMM dd, yy hh:mm a</property>
                            </structure>
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">today</property>
                        </data>
                    </cell>
                </row>
                <row id="4255">
                    <property name="backgroundColor">#DCDCDC</property>
                    <cell id="4256">
                        <property name="paddingBottom">5pt</property>
                        <label id="4202">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="marginBottom">-1pt</property>
                            <property name="paddingTop">0pt</property>
                            <property name="paddingBottom">0pt</property>
                            <property name="textAlign">left</property>
                            <text-property name="text">Week Of Year</text-property>
                        </label>
                    </cell>
                    <cell id="4257">
                        <text id="4204">
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[Paid]]></text-property>
                        </text>
                    </cell>
                    <cell id="4258">
                        <property name="fontSize">8pt</property>
                    </cell>
                    <cell id="4259">
                        <property name="fontSize">8pt</property>
                    </cell>
                    <cell id="4260">
                        <property name="fontSize">8pt</property>
                    </cell>
                    <cell id="4262"/>
                    <cell id="4263"/>
                    <cell id="4264"/>
                </row>
            </header>
            <detail>
                <row id="4302">
                    <list-property name="highlightRules">
                        <structure>
                            <property name="operator">eq</property>
                            <property name="backgroundColor">#F0F0F0</property>
                            <expression name="testExpr" type="javascript">row.__rownum % 2</expression>
                            <simple-property-list name="value1">
                                <value type="javascript">0</value>
                            </simple-property-list>
                        </structure>
                        <structure>
                            <property name="operator">ne</property>
                            <expression name="testExpr" type="javascript">row.__rownum % 2</expression>
                            <simple-property-list name="value1">
                                <value type="javascript">0</value>
                            </simple-property-list>
                        </structure>
                    </list-property>
                    <cell id="4303">
                        <data id="4312">
                            <property name="fontSize">8pt</property>
                            <property name="textAlign">left</property>
                            <property name="resultSetColumn">week</property>
                        </data>
                    </cell>
                    <cell id="4304">
                        <data id="4313">
                            <property name="fontSize">8pt</property>
                            <property name="textAlign">left</property>
                            <property name="resultSetColumn">paid</property>
                        </data>
                    </cell>
                    <cell id="4305"/>
                    <cell id="4306"/>
                    <cell id="4307"/>
                    <cell id="4309"/>
                    <cell id="4310"/>
                    <cell id="4311"/>
                </row>
            </detail>
        </table>
    </body>
</report>
